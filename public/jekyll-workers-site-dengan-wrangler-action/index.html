<!doctype html><html lang=en-us><head><meta charset=utf-8><title>Jekyll Workers Site Dengan Wrangler Action</title><meta name=author content="Book Lover"><meta name=description content="Pecinta segala buku"><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=5"><link rel=icon href=https://kutubuku.surge.sh/images/favicon.png type=image/x-icon><link rel=preconnect href=https://fonts.gstatic.com><link rel=stylesheet href="https://fonts.googleapis.com/css2?family=Lora:wght@500;600;700;800;900&display=swap"><link rel=stylesheet href=https://kutubuku.surge.sh/css/vendor.min.06b69bb39b28330c3f7e7c94b81f7bcc9f6d0ba393574e7e809bf3406ee829c148428d6ca3c058d6c2c7ab54ee96bfabbf53c2c857e2c5cb3cc4e681344681e9.css integrity="sha512-Brabs5soMww/fnyUuB97zJ9tC6OTV05+gJvzQG7oKcFIQo1so8BY1sLHq1Tulr+rv1PCyFfixcs8xOaBNEaB6Q==" media=screen></head><body><div class=header-height-fix></div><header class=header-nav><div class=container><div class=row><div class=col-12><nav class="navbar navbar-expand-lg navbar-light p-0"><a class="navbar-brand font-weight-bold mr-0" href=https://kutubuku.surge.sh/><img loading=lazy src=https://kutubuku.surge.sh/images/logo.png alt="KutuBuku - Personal Blog" height=35px></a>
<button class="search-toggle d-inline-block d-lg-none ml-auto mr-3" data-toggle=search aria-label="Search Toggle">
<i class="las la-search"></i></button>
<button class=navbar-toggler type=button data-toggle=collapse data-target=#navHeader aria-controls=navHeader aria-expanded=false aria-label="Toggle navigation">
<i class="d-inline lab la-buromobelexperte"></i><i class="d-none las la-times"></i></button><div class="collapse navbar-collapse" id=navHeader><ul class="navbar-nav mx-auto"><li class=nav-item><a class=nav-link href=https://kutubuku.surge.sh/>Home</a></li><li class=nav-item><a class=nav-link href=https://kutubuku.surge.sh/about>About</a></li><li class=nav-item><a class=nav-link href=https://kutubuku.surge.sh/contact>Contact</a></li><li class="nav-item dropdown"><a class="nav-link dropdown-toggle d-inline-block" href=# role=button data-toggle=dropdown aria-expanded=false>Pages</a><ul class=dropdown-menu><li><a class=dropdown-item href=https://kutubuku.surge.sh/author/>Author</a></li><li><a class=dropdown-item href=https://kutubuku.surge.sh/tags/>Tags</a></li><li><a class=dropdown-item href=https://kutubuku.surge.sh/categories/>Category</a></li><li><a class=dropdown-item href=https://kutubuku.surge.sh/elements/>Elements</a></li><li><a class=dropdown-item href=https://kutubuku.surge.sh/privacy/>Privacy</a></li><li><a class=dropdown-item href=https://kutubuku.surge.sh/terms-conditions/>Terms & Conditions</a></li></ul></li></ul><div class="navbar-right d-none d-lg-inline-block"><ul class="social-links list-unstyled list-inline"><li class="list-inline-item ml-4 d-none d-lg-inline-block"><button class=search-toggle data-toggle=search aria-label="Search Toggle">
<i class="las la-search"></i></button></li></ul></div></div></nav></div></div></div></header><div class=search-block><div data-toggle=search-close><i class="las la-times text-primary"></i></div><form action=/search><input id=search-query name=s type=search placeholder="Type words & hit enter" class=text-center aria-label=search-query></form></div><section class="section-sm pb-2 page-header"><div class=container><div class=row><div class="col-8 mx-auto text-center"><h3 class="mb-3 text-dark font-weight-bold">Jekyll Workers Site Dengan Wrangler Action</h3><ul class="list-inline breadcrumb-menu"><li class=list-inline-item><a href=/>Home</a></li><li class=list-inline-item>/ &nbsp; <a href=https://kutubuku.surge.sh/jekyll-workers-site-dengan-wrangler-action>Jekyll workers site dengan wrangler action</a></li></ul></div></div></div></section><section class=section-sm><div class=container><div class="row justify-content-center"><div class=col-lg-10><div class="text-center mb-5"><h3 class="h2 mb-4 post-title">Jekyll Workers Site Dengan Wrangler Action</h3><ul class="card-meta list-inline"><li class=list-inline-item><a href=#! class=card-meta-author></a></li><li class=list-inline-item>|</li><li class=list-inline-item><span>05 February 2021</span></li></ul></div><div class="mb-5 text-center"><img loading=lazy class="img-fluid rounded" src=https://kutubuku.surge.sh/img/workers-social.png alt="Image not Found"></div><div class=content><p>Setelah penghujung akhir tahun blog ini pindah dari wordpress ke jekyll lalu dihost dengan github pages, akhirnya mencoba dengan workers site salah fitur yang sudah ada sejak lama di dahbord cloudflare namun hanya diklik.</p><h2 id=belajar-cloudflare-workers>Belajar cloudflare workers</h2><p>Percobaan yang panjang belajar tentang workers, pertama hanya menggunakan konsol javascript dengan fungsi untuk mengalihkan alamat lama ke alamat baru dengan massal <a href=https://wildanfauzy.com/bulk-redirect-domain-dengan-workers/ title="bulk redirect">bulk redirect</a>.</p><p>Masa transisi ke static site memang cukup menyita banyak waktu. mulai dari meng-convert semua postingan ke format yang baru, sialnya jumlah postingan dari 2012 sampai sekarang banyak yang tidak singkron.</p><p>Alhasil tidak semua tertata dengan rapih, yang terpentik permalink postingan tidak berubah dan gambar thumbnail masih tersimpan, mungkin ada beberapa gambar dalam postingan yang rusak.</p><p>Setelah berhasil pindah ke static site yang kami rasakan semakin produktif, tidak ada lagi setiap ingin menulis postingan terganggu oleh notifikasi update tema atau plugins, atau komentar spam yang banyak, apalagi sering sekali blog terkena brute force attack membuat blog sering internal server error.</p><h2 id=masa-percobaan-trial-and-error>Masa Percobaan Trial and Error</h2><p>Hal yang dirasakan setelah pindah ke ssg jekyll di github pages kini mencoba workers site, sebelum menerapkan cloudflare workers di blog ini, percobaan adalah di blog aidanblog.com.</p><p>Banyak error dan trial, tapi setelah percobaan yang berulang akhirnya berhasil, perlu diingat workers site versi gratis ada limitasi, sehingga perlu diperhatikan deploy time yang efesien.</p><p>Pertama mencoba dengan wrangler CLI, namun proses instalasi wrangler di laptop cuku sulit, install melalui NPM banyak masalah seperti permission denied, lalu berhasil install wrangler menggunakan cargo.</p><pre><code>npm install -g @cloudflare/wrangler
wrangler config
wrangler generate --site my-site
cd my-site
wrangler publish
</code></pre><p>Percobaan deploy local di komputer tetapi membutuhkan waktu yang cukup lama karena harus mendeploy jekyll sebelumnya lalu publih ke KV namespace menggunakan wrangler.</p><p>Lalu Percobaan kedua dengan landing page menggunakan gatsby yang saya sudah posting <a href=https://wildanfauzy.com/deploy-gatsby-website-di-cloudflare-workers/ title="deploy gatsby to workers">deploy gatsby ke cloudflare workers</a> namun car tersebut kurang efesien jika kalian mengupdate postingan setiap hari.</p><h2 id=deploy-dan-publish-dengan-wrangler-github-action>Deploy dan Publish dengan Wrangler Github Action</h2><p>Lalu percobaan selanjutnya dengan blog portofolio di a.idan.my.id (gatsby) dan blog gado-gado catatan sehari-hari di aidanblog.com (jekyll) akhirnya mendapatkan yang efesien.</p><p>Pertama build jekyll site dengan docker mendapatkan build time yang efesien yaitu 32 detik dengan postingan ratusan, sebelumnya dengan menginstall bundler dan bundle exec yang memakan waktu empat menit, build jekyll site with docker.</p><pre><code>name: Jekyll site CI

on:
  push:
    branches: [ master ]
  pull_request:
    branches: [ master ]

jobs:
  build:

    runs-on: ubuntu-latest

    steps:
    - uses: actions/checkout@v2
    - name: Build the site in the jekyll/builder container
      run: |
        docker run \
        -v ${{ github.workspace }}:/srv/jekyll -v ${{ github.workspace }}/_site:/srv/jekyll/_site \
        jekyll/builder:latest /bin/bash -c &quot;chmod 777 /srv/jekyll &amp;&amp; jekyll build --future&quot;
</code></pre><p>Menggunakan docker walapun cepat namun menggenerate setiap saat melakukan push ke repo, tidak bisa menggunakan cache. setelah berhasil build jekyll selanjutnya menginstall wrangler action.</p><pre><code>name: Deploy

on:
  push:
    branches:
      - master

jobs:
  deploy:
    runs-on: ubuntu-latest
    name: Deploy
    steps:
      - uses: actions/checkout@v2
      - name: Publish
        uses: cloudflare/wrangler-action@1.3.0
        with:
          apiToken: ${{ secrets.CF_API_TOKEN }}
</code></pre><p>Namun di cloudflare workers free ada batasan yang paling sering mengganggu adalah masalah write and read yang dibatasi 1000 request setiap harinya, alhasil selalu kena limit, untuk mengatasinya dengan menyetel cron jobs di workflows.</p><pre><code>on:
  schedule:
    - cron: '0 * * * *'

jobs:
  deploy:
    runs-on: ubuntu-latest
    name: Deploy
    steps:
      - uses: actions/checkout@master
      - name: Publish app
        uses: cloudflare/wrangler-action@1.2.0
        with:
          apiToken: ${{ secrets.CF_API_TOKEN }}
</code></pre><p>Hasil akhir mendapatkan build time satu menit sampai berhasil publish ke cloudflare dengan steps build jekyll site dengan docker dan install wrangler setelah itu publish site, lalu mengatur cron jobs setiap enam jam sekali untuk meminimalisir limits, seperti ini pangaturan workflows yang digunakan di blog ini.</p><pre><code>name: Deploy to workers-site

on:
  schedule:
    - cron: '0 */6 * * *'

jobs:
  build:

    runs-on: ubuntu-latest

    steps:
    - uses: actions/checkout@v2
      
    - name: Build the site in the jekyll/builder container
      run: |
        docker run \
        -v ${{ github.workspace }}:/srv/jekyll -v ${{ github.workspace }}/_site:/srv/jekyll/_site \
        jekyll/builder:latest /bin/bash -c &quot;chmod 777 /srv/jekyll &amp;&amp; jekyll build&quot;
    - name: Install Wrangler
      run: sudo npm i @cloudflare/wrangler -g

    - name: Publish
      uses: cloudflare/wrangler-action@1.2.0
      env:
        USER: root
      with:
        apiToken: ${{ secrets.CF_API_TOKEN }}
        environment: 'production'
</code></pre><p>Setelah itu berhasil menggunakan workers-site dengan build time yang efesien, selanjutnya membuat konfigurasi wrangler.toml dan akhirnya bisa memilih bucket ke _site setelah build jekyll dengan docker.</p><p>Selamat mencoba, jika ingin melihat repo gihub blog ini bisa dilihat di bagiang footer dan klik (<a href=https://github.com/NgopiBrek/WildanFauzy.com title="jekyll workers">view source</a>) untuk melihat pengaturan yang saya gunakan dengan wrangler github action, terinspirasi oleh repostory <a href=https://github.com/vences/hugo-workers title="hugo workers">vences/hugo-workers</a></p></div></div></div><div class=single-post-meta><div class="row justify-content-center"><div class="col-lg-5 col-md-6 text-center text-md-left"><ul class="post-meta-tags list-unstyled list-inline"><li class=list-inline-item><a href=https://kutubuku.surge.sh/tags/jekyll>jekyll</a></li><li class=list-inline-item><a href=https://kutubuku.surge.sh/tags/workers-site>workers-site</a></li></ul></div><div class="col-lg-5 col-md-6 text-center text-md-right mt-4 mt-md-0"><ul class="social-links has-bg-color list-unstyled list-inline" style=line-height:0><li class=list-inline-item><a class="resp-sharing-button__link d-block" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fkutubuku.surge.sh%2fjekyll-workers-site-dengan-wrangler-action%2f" target=_blank rel=noopener aria-label><div class="resp-sharing-button resp-sharing-button--facebook resp-sharing-button--small"><div aria-hidden=true class="resp-sharing-button__icon resp-sharing-button__icon--solid"><i class="lab la-facebook-f text-dark"></i></div></div></a></li><li class=list-inline-item><a class="resp-sharing-button__link d-block" href="https://twitter.com/intent/tweet/?text=Jekyll%20Workers%20Site%20Dengan%20Wrangler%20Action&url=https%3a%2f%2fkutubuku.surge.sh%2fjekyll-workers-site-dengan-wrangler-action%2f" target=_blank rel=noopener aria-label><div class="resp-sharing-button resp-sharing-button--twitter resp-sharing-button--small"><div aria-hidden=true class="resp-sharing-button__icon resp-sharing-button__icon--solid"><i class="lab la-twitter text-dark"></i></div></div></a></li><li class=list-inline-item><a class="resp-sharing-button__link d-block" href="https://plus.google.com/share?url=https%3a%2f%2fkutubuku.surge.sh%2fjekyll-workers-site-dengan-wrangler-action%2f" target=_blank rel=noopener aria-label><div class="resp-sharing-button resp-sharing-button--google resp-sharing-button--small"><div aria-hidden=true class="resp-sharing-button__icon resp-sharing-button__icon--solid"><i class="lab la-google-plus-g text-dark"></i></div></div></a></li><li class=list-inline-item><a class="resp-sharing-button__link d-block" href="mailto:?subject=Jekyll%20Workers%20Site%20Dengan%20Wrangler%20Action&body=https%3a%2f%2fkutubuku.surge.sh%2fjekyll-workers-site-dengan-wrangler-action%2f" target=_self rel=noopener aria-label><div class="resp-sharing-button resp-sharing-button--email resp-sharing-button--small"><div aria-hidden=true class="resp-sharing-button__icon resp-sharing-button__icon--solid"><i class="las la-envelope text-dark"></i></div></div></a></li><li class=list-inline-item><a class="resp-sharing-button__link d-block" href="whatsapp://send?text=Jekyll%20Workers%20Site%20Dengan%20Wrangler%20Action%20https%3a%2f%2fkutubuku.surge.sh%2fjekyll-workers-site-dengan-wrangler-action%2f" target=_blank rel=noopener aria-label><div class="resp-sharing-button resp-sharing-button--whatsapp resp-sharing-button--small"><div aria-hidden=true class="resp-sharing-button__icon resp-sharing-button__icon--solid"><i class="lab la-whatsapp text-dark"></i></div></div></a></li></ul></div></div></div><div class=single-post-author><div class="row justify-content-center"><div class=col-lg-10><div class="media d-block d-sm-flex text-center text-sm-left"></div></div></div></div><div class=single-post-similer><div class="row justify-content-center"><div class=col-lg-10><div class="row mt-3"><div class=col-12><h3 class="text-dark font-weight-800 mb-4 pb-2">You May Also Like</h3></div><div class=col-md-6><article class="card post-card"><a href=https://kutubuku.surge.sh/menulis-dengan-typora/><img loading=lazy class="w-100 rounded" src=https://kutubuku.surge.sh/img/typora-1.png alt="Menulis Dengan Typora"></a><div class=card-body><ul class="card-meta list-inline mb-2"><li class="list-inline-item mb-2"></li><li class="list-inline-item mb-2"><span>01 Jan, 2021</span></li><li class="list-inline-item mb-2"><ul class="card-meta-tag list-inline"><li class=list-inline-item><a href=https://kutubuku.surge.sh/tags/typora>typora</a></li><li class=list-inline-item><a href=https://kutubuku.surge.sh/tags/menulis>menulis</a></li><li class=list-inline-item><a href=https://kutubuku.surge.sh/tags/jekyll>jekyll</a></li></ul></li></ul><h3 class=mb-3><a class=post-title href=https://kutubuku.surge.sh/menulis-dengan-typora/>Menulis Dengan Typora</a></h3><p>Sebelumnya saya ucapkan selamat tahun baru untuk manusia yang masih sanggup hidup di dunia, memang tahun baru kali ini tidak sama dengan tahun baru …</p></div></article></div><div class=col-md-6><article class="card post-card"><a href=https://kutubuku.surge.sh/cloudcannon-vs-forestry-untuk-posting-di-jekyll/><img loading=lazy class="w-100 rounded" src=https://kutubuku.surge.sh/img/pexels-leah-kelley-952594_r7cgtt.jpg alt="CloudCannon Vs Forestry Untuk Posting di Jekyll"></a><div class=card-body><ul class="card-meta list-inline mb-2"><li class="list-inline-item mb-2"></li><li class="list-inline-item mb-2"><span>20 Dec, 2020</span></li><li class="list-inline-item mb-2"><ul class="card-meta-tag list-inline"><li class=list-inline-item><a href=https://kutubuku.surge.sh/tags/forestry.io>forestry.io</a></li><li class=list-inline-item><a href=https://kutubuku.surge.sh/tags/cloudcannon>cloudcannon</a></li><li class=list-inline-item><a href=https://kutubuku.surge.sh/tags/jekyll>jekyll</a></li></ul></li></ul><h3 class=mb-3><a class=post-title href=https://kutubuku.surge.sh/cloudcannon-vs-forestry-untuk-posting-di-jekyll/>CloudCannon Vs Forestry Untuk Posting di Jekyll</a></h3><p>Setelah pindah cms blog dari wordpress ke jekyll, banyak perubahan yang terasa, terutama ketika hendak membuat postingan baru, jika di wordpress …</p></div></article></div></div></div></div></div></div></section><footer class=section-sm><div class=container><div class="row justify-content-center align-items-center"><div class=col-lg-5><div class="newsletter-block font-primary"><h3 class="h4 mb-4 font-weight-700 text-center">Subscribe for our monthly newsletter.</h3><form class="px-0 px-sm-3 px-md-5" action="https://gmail.us4.list-manage.com/subscribe/post?u=463ee871f45d2d93748e77cad&amp;amp;id=a0a2c6d074" method=post name=mailchimp_form_name target=_blank><div class=input-group><input form=subscription type=text class=form-control placeholder="Enter your email" aria-label=Subscription required autocomplete=new-email><div class=input-group-append><button type=submit name=subscription class=input-group-text aria-label="Subscription Button"><i class="icon las la-paper-plane"></i></button></div></div><div style=position:absolute;left:-5000px aria-hidden=true><input type=text name=b_463ee871f45d2d93748e77cad_a0a2c6d074 tabindex=-1></div></form></div></div><div class="col-lg-12 text-center mt-5"><ul class="list-inline footer-menu mb-4"><li class="list-inline-item mx-3"><a href=https://kutubuku.surge.sh/about/>About</a></li><li class="list-inline-item mx-3"><a href=https://kutubuku.surge.sh/author/>Authors</a></li><li class="list-inline-item mx-3"><a href=https://kutubuku.surge.sh/privacy/>Privacy</a></li><li class="list-inline-item mx-3"><a href=https://kutubuku.surge.sh/terms-conditions/>Terms & Conditions</a></li></ul><ul class="social-links icon-box list-unstyled list-inline font-weight-500 mb-3"><li class="list-inline-item text-center"><a href=https://www.facebook.com/wilfauzy aria-label=social-icon><i class="lab lab la-facebook-f"></i></a></li><li class="list-inline-item text-center"><a href=https://www.twitter.com/wilfauzy aria-label=social-icon><i class="lab lab la-twitter"></i></a></li><li class="list-inline-item text-center"><a href=https://www.instagram.com/wilfauzy aria-label=social-icon><i class="lab lab la-instagram"></i></a></li></ul><p class="mb-0 font-weight-500 copyright-text content">Designed & Developed By <a href=https://gethugothemes.com/>Gethugothemes</a></p></div></div></div></footer><script data-turbolinks-suppress-warning src=/js/vendor.min.145a21dc1d3b6180ba4053b597f77d01206a5207dbc280de83d4151958109b94fad45e42ce423c4c4cf0cef270a67279b4db5d19f05e3eee33b3838de0028318.js integrity="sha512-FFoh3B07YYC6QFO1l/d9ASBqUgfbwoDeg9QVGVgQm5T61F5CzkI8TEzwzvJwpnJ5tNtdGfBePu4zs4ON4AKDGA=="></script></body></html>