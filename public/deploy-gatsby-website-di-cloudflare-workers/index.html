<!doctype html><html lang=en-us><head><meta charset=utf-8><title>Deploy Gatsby Website di Cloudflare Workers</title><meta name=author content="Book Lover"><meta name=description content="Pecinta segala buku"><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=5"><link rel=icon href=https://kutubuku.surge.sh/images/favicon.png type=image/x-icon><link rel=preconnect href=https://fonts.gstatic.com><link rel=stylesheet href="https://fonts.googleapis.com/css2?family=Lora:wght@500;600;700;800;900&display=swap"><link rel=stylesheet href=https://kutubuku.surge.sh/css/vendor.min.06b69bb39b28330c3f7e7c94b81f7bcc9f6d0ba393574e7e809bf3406ee829c148428d6ca3c058d6c2c7ab54ee96bfabbf53c2c857e2c5cb3cc4e681344681e9.css integrity="sha512-Brabs5soMww/fnyUuB97zJ9tC6OTV05+gJvzQG7oKcFIQo1so8BY1sLHq1Tulr+rv1PCyFfixcs8xOaBNEaB6Q==" media=screen></head><body><div class=header-height-fix></div><header class=header-nav><div class=container><div class=row><div class=col-12><nav class="navbar navbar-expand-lg navbar-light p-0"><a class="navbar-brand font-weight-bold mr-0" href=https://kutubuku.surge.sh/><img loading=lazy src=https://kutubuku.surge.sh/images/logo.png alt="KutuBuku - Personal Blog" height=35px></a>
<button class="search-toggle d-inline-block d-lg-none ml-auto mr-3" data-toggle=search aria-label="Search Toggle">
<i class="las la-search"></i></button>
<button class=navbar-toggler type=button data-toggle=collapse data-target=#navHeader aria-controls=navHeader aria-expanded=false aria-label="Toggle navigation">
<i class="d-inline lab la-buromobelexperte"></i><i class="d-none las la-times"></i></button><div class="collapse navbar-collapse" id=navHeader><ul class="navbar-nav mx-auto"><li class=nav-item><a class=nav-link href=https://kutubuku.surge.sh/>Home</a></li><li class=nav-item><a class=nav-link href=https://kutubuku.surge.sh/about>About</a></li><li class=nav-item><a class=nav-link href=https://kutubuku.surge.sh/contact>Contact</a></li><li class="nav-item dropdown"><a class="nav-link dropdown-toggle d-inline-block" href=# role=button data-toggle=dropdown aria-expanded=false>Pages</a><ul class=dropdown-menu><li><a class=dropdown-item href=https://kutubuku.surge.sh/author/>Author</a></li><li><a class=dropdown-item href=https://kutubuku.surge.sh/tags/>Tags</a></li><li><a class=dropdown-item href=https://kutubuku.surge.sh/categories/>Category</a></li><li><a class=dropdown-item href=https://kutubuku.surge.sh/elements/>Elements</a></li><li><a class=dropdown-item href=https://kutubuku.surge.sh/privacy/>Privacy</a></li><li><a class=dropdown-item href=https://kutubuku.surge.sh/terms-conditions/>Terms & Conditions</a></li></ul></li></ul><div class="navbar-right d-none d-lg-inline-block"><ul class="social-links list-unstyled list-inline"><li class="list-inline-item ml-4 d-none d-lg-inline-block"><button class=search-toggle data-toggle=search aria-label="Search Toggle">
<i class="las la-search"></i></button></li></ul></div></div></nav></div></div></div></header><div class=search-block><div data-toggle=search-close><i class="las la-times text-primary"></i></div><form action=/search><input id=search-query name=s type=search placeholder="Type words & hit enter" class=text-center aria-label=search-query></form></div><section class="section-sm pb-2 page-header"><div class=container><div class=row><div class="col-8 mx-auto text-center"><h3 class="mb-3 text-dark font-weight-bold">Deploy Gatsby Website di Cloudflare Workers</h3><ul class="list-inline breadcrumb-menu"><li class=list-inline-item><a href=/>Home</a></li><li class=list-inline-item>/ &nbsp; <a href=https://kutubuku.surge.sh/deploy-gatsby-website-di-cloudflare-workers>Deploy gatsby website di cloudflare workers</a></li></ul></div></div></div></section><section class=section-sm><div class=container><div class="row justify-content-center"><div class=col-lg-10><div class="text-center mb-5"><h3 class="h2 mb-4 post-title">Deploy Gatsby Website di Cloudflare Workers</h3><ul class="card-meta list-inline"><li class=list-inline-item><a href=#! class=card-meta-author></a></li><li class=list-inline-item>|</li><li class=list-inline-item><span>31 January 2021</span></li></ul></div><div class="mb-5 text-center"><img loading=lazy class="img-fluid rounded" src=https://kutubuku.surge.sh/img/gatsby-website.png alt="Image not Found"></div><div class=content><p>Kali ini ingin membahas tentang framwork gatsbyJS dan Cloudflare Workers, sudah hampir satu bulan lebih menunggu cloudflare pages resmi realese namun sudah daftar beta request belum dapat saja aksesnya.</p><p>Akhirnya masih setia dengan workers-nya, sudah tidak perlu dijelaskan lagi apa itu cloudflare workers sudah pernah dibahas juga di blog ini, salah satu framework yang keren menurut saya adalah gasbyjs.</p><h2 id=build-gatsby-dengan-github-action>Build Gatsby dengan Github Action</h2><p>Pertama sebelum mendeploy gatsby website kalian di cloudflare workers sebelumnya harus mem-build di komputer lokal kalian dengan perintah <em>&ldquo;gatsby build&rdquo;</em> atau dengan wrangler namun disini saya lebih memilih menggunakan github action untuk build gatsby webiste.</p><p>Salah satu alasanya kalo deploy secara lokal di komputer itu membutuhkan waktu lama kalo build gatsby karena laptop saya yang butut wkkwkw, harus ganti ke mekbuk m1 keknya.</p><p>Pertama siapkan repostory github kalian lalu masuk ke pilihan github action, dan masukan baris gatsby publish di workflows, seperti ini.</p><pre><code>name: Gatsby Publish

on:
  push:
    branches:
      - main

jobs:
  build:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v1
      - uses: enriikke/gatsby-gh-pages-action@v2
        with:
          access-token: ${{ secrets.ACCESS_TOKEN }}
          deploy-branch: www
          gatsby-args: --prefix-paths
</code></pre><p>Sesuaikan branch yang ingin di build gasby webiste kalian, defaultnya master atau main, lalu pilih deploy-branch sebagai output dari hasil buildnya, disini saya menggunakan nama branch www sebagai hasil deploy.</p><p>Namun sebelumnya memerlukan akses token github kalian, cara mendapatkan akses token github kalian bisa membuat di pengaturan profil lalu pilih developer setiing, jika sudah berhasil dibuat simpan baik-baik.</p><p>Selanjutnya simpan akses token tersebut di pengaturan repo lalu pilih secret seperti ini.</p><p><img src=https://i0.wp.com/wildanfauzy.com/img/token.png alt>Jika sudah lakukan push ke repostory untuk mentriger github-action yang sudah dibuat lalu tunggu beberapa detik sampai gatsby website kalian berhasil dibuat dan mendapatkan branch baru dengan hasil dari output tadi seperti ini.</p><p><img src=https://i0.wp.com/wildanfauzy.com/img/gatsby.png alt>Selamat website dengan framework gatsby kalian berhasil dibuat, selanjutnya kalian bisa menggunakan dengan github pages atau yang lainnya, namun karena disini saya ingin menggunakan cloudflare workers.</p><h2 id=deploy-gatsby-website-ke-workers>Deploy gatsby website ke workers</h2><p>Selanjutnya mendeploy gatsby website ke cloudflare workers dengan github action, hal yang perlu diperhatikan kalian harus membuat api token cloudflare workers, bisa dibuat di profil cloudflare lalu pilih api token dan sesuaikan dengan akses ke workers, seperti ini.</p><p><img src=https://i0.wp.com/wildanfauzy.com/img/api-workers.png alt>Pilih template &ldquo;edit cloudflare workers&rdquo; setelah berhasil membuat api cloudflare workers, simpan api token itu dengan baik-baik jangan sampai lupa, selanjutnya menyimpan api token tersebut di secret repostrory kalian.</p><p>Jika sudah menyimpan api token, sebelumnya membuat pengaturan wrangler.toml sesuai dengan info akun cloudflare kalian, seperti zona id dan account id, bisa kalian dapatkan di dashboard cloudflare, konfigurasi wrangler.toml seperti ini.</p><pre><code>name = &quot;warkop&quot;
type = &quot;javascript&quot;
account_id = &quot;AKUN ID CLOUDFLARE KALIAN&quot;
workers_dev = true

[env.production]
workers_dev = false
route = &quot;https://www.aep.my.id/*&quot;
zone_id = &quot;ZONE ID CLOUDFLARE KALIAN&quot;

[site]
bucket = &quot;./&quot;
entry-point = &quot;workers-site&quot;
</code></pre><p>Simpan konfigurasi wrangler.toml tersebut di branch dimana hasil output gatsby website, disini saya menyimpan di branch www, selanjutnya menjalankan github action untuk mendeploy ke cloudflare workers, seperti ini.</p><pre><code>name: Deploy

on:
  push:
    branches:
      - www
jobs:
  deploy:
    runs-on: ubuntu-latest
    name: Deploy
    steps:
      - uses: actions/checkout@master
      - name: Publish
        uses: cloudflare/wrangler-action@1.2.0
        env:
          USER: root
        with:
          apiToken: ${{ secrets.CF_API_TOKEN }}
</code></pre><p>Simpan pengaturan github-action itu sesuka kalian bisa di master atau branch hasil output build gatsby, dengan membuat workflows di folder &ldquo;.github/workflows/cloudflare-workers.yml&rdquo; lalu tunggu beberapa detik sampai proses deploy ke workers selesai.</p><p><img src=https://i0.wp.com/wildanfauzy.com/img/worker.png alt>Jika berhasil selamat gatsby website kalian berhasil diupload ke workers, maka akan menghasilkan alamat webite dengan nama projek yang kalian buat dengan subdomain workers.dev, seperti disini hasil workers websitenya menghasilkan alamat warkop.aku.workers.dev seperti itu.</p><h2 id=route-website-workers-ke-alamat-domain>Route website workers ke alamat domain</h2><p>Setelah berhasil mendeploy, kalian mendapatkan alamat website dengan subdomain workers.dev namun rasanya kurang gitu, lalu bagaimana menghubungkan ke domain kalian?</p><p>Petama masuk ke dashboard cloudflare lalu klik tab workes, selanjutnya add route untuk mengbungkan ke alamat domain kalian.</p><p><img src=https://i0.wp.com/wildanfauzy.com/img/route.png alt></p><p>Seperti gambar diatas, sambungkan alamat domain dengan workers yang sudah kalian buat, perlu diingat awan orange di dns harus diaktifkan agar workers berjalan.</p><p>Sudah deh jadi,</p><ul><li><p>Repostory projek: <a href=https://github.com/wilfauzy/Warkop title=https://github.com/wilfauzy/Warkop>https://github.com/wilfauzy/Warkop</a></p></li><li><p>Tema Gatsby: <a href=https://www.gatsbyjs.com/starters/ajayns/gatsby-absurd title="theme gatsby absurd">Gatsby Absurd</a></p></li><li><p>Alamat website projek: <a href=https://www.aep.my.id/ title=https://www.aep.my.id/>https://www.aep.my.id/</a></p></li><li><p>Workers website: <a href=https://warkop.aku.workers.dev/ title=https://warkop.aku.workers.dev/>https://warkop.aku.workers.dev/</a></p></li></ul></div></div></div><div class=single-post-meta><div class="row justify-content-center"><div class="col-lg-5 col-md-6 text-center text-md-left"><ul class="post-meta-tags list-unstyled list-inline"><li class=list-inline-item><a href=https://kutubuku.surge.sh/tags/gatsby>gatsby</a></li><li class=list-inline-item><a href=https://kutubuku.surge.sh/tags/cloudflare>cloudflare</a></li><li class=list-inline-item><a href=https://kutubuku.surge.sh/tags/workers>workers</a></li></ul></div><div class="col-lg-5 col-md-6 text-center text-md-right mt-4 mt-md-0"><ul class="social-links has-bg-color list-unstyled list-inline" style=line-height:0><li class=list-inline-item><a class="resp-sharing-button__link d-block" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fkutubuku.surge.sh%2fdeploy-gatsby-website-di-cloudflare-workers%2f" target=_blank rel=noopener aria-label><div class="resp-sharing-button resp-sharing-button--facebook resp-sharing-button--small"><div aria-hidden=true class="resp-sharing-button__icon resp-sharing-button__icon--solid"><i class="lab la-facebook-f text-dark"></i></div></div></a></li><li class=list-inline-item><a class="resp-sharing-button__link d-block" href="https://twitter.com/intent/tweet/?text=Deploy%20Gatsby%20Website%20di%20Cloudflare%20Workers&url=https%3a%2f%2fkutubuku.surge.sh%2fdeploy-gatsby-website-di-cloudflare-workers%2f" target=_blank rel=noopener aria-label><div class="resp-sharing-button resp-sharing-button--twitter resp-sharing-button--small"><div aria-hidden=true class="resp-sharing-button__icon resp-sharing-button__icon--solid"><i class="lab la-twitter text-dark"></i></div></div></a></li><li class=list-inline-item><a class="resp-sharing-button__link d-block" href="https://plus.google.com/share?url=https%3a%2f%2fkutubuku.surge.sh%2fdeploy-gatsby-website-di-cloudflare-workers%2f" target=_blank rel=noopener aria-label><div class="resp-sharing-button resp-sharing-button--google resp-sharing-button--small"><div aria-hidden=true class="resp-sharing-button__icon resp-sharing-button__icon--solid"><i class="lab la-google-plus-g text-dark"></i></div></div></a></li><li class=list-inline-item><a class="resp-sharing-button__link d-block" href="mailto:?subject=Deploy%20Gatsby%20Website%20di%20Cloudflare%20Workers&body=https%3a%2f%2fkutubuku.surge.sh%2fdeploy-gatsby-website-di-cloudflare-workers%2f" target=_self rel=noopener aria-label><div class="resp-sharing-button resp-sharing-button--email resp-sharing-button--small"><div aria-hidden=true class="resp-sharing-button__icon resp-sharing-button__icon--solid"><i class="las la-envelope text-dark"></i></div></div></a></li><li class=list-inline-item><a class="resp-sharing-button__link d-block" href="whatsapp://send?text=Deploy%20Gatsby%20Website%20di%20Cloudflare%20Workers%20https%3a%2f%2fkutubuku.surge.sh%2fdeploy-gatsby-website-di-cloudflare-workers%2f" target=_blank rel=noopener aria-label><div class="resp-sharing-button resp-sharing-button--whatsapp resp-sharing-button--small"><div aria-hidden=true class="resp-sharing-button__icon resp-sharing-button__icon--solid"><i class="lab la-whatsapp text-dark"></i></div></div></a></li></ul></div></div></div><div class=single-post-author><div class="row justify-content-center"><div class=col-lg-10><div class="media d-block d-sm-flex text-center text-sm-left"></div></div></div></div><div class=single-post-similer><div class="row justify-content-center"><div class=col-lg-10><div class="row mt-3"><div class=col-12><h3 class="text-dark font-weight-800 mb-4 pb-2">You May Also Like</h3></div><div class=col-md-6><article class="card post-card"><a href=https://kutubuku.surge.sh/bulk-redirect-domain-dengan-workers/><img loading=lazy class="w-100 rounded" src=https://kutubuku.surge.sh/wp-content/uploads/2020/11/bulk-redirect.png alt="Bulk Redirect Domain Dengan Workers"></a><div class=card-body><ul class="card-meta list-inline mb-2"><li class="list-inline-item mb-2"></li><li class="list-inline-item mb-2"><span>23 Nov, 2020</span></li><li class="list-inline-item mb-2"><ul class="card-meta-tag list-inline"><li class=list-inline-item><a href=https://kutubuku.surge.sh/tags/cloudflare>cloudflare</a></li><li class=list-inline-item><a href=https://kutubuku.surge.sh/tags/serverless>serverless</a></li><li class=list-inline-item><a href=https://kutubuku.surge.sh/tags/workers>workers</a></li></ul></li></ul><h3 class=mb-3><a class=post-title href=https://kutubuku.surge.sh/bulk-redirect-domain-dengan-workers/>Bulk Redirect Domain Dengan Workers</a></h3><p>Gatel kalo liat diskonan, habis bangun tidur dapet notif diskonan domain .com setengah sadar akhirnya mencet checkout, wassalam akhirnya beli domain …</p></div></article></div><div class=col-md-6><article class="card post-card"><a href=https://kutubuku.surge.sh/cloudflare-workers-dan-blog-jekyll-serverless/><img loading=lazy class="w-100 rounded" src=https://kutubuku.surge.sh/wp-content/uploads/2020/11/serverless-cloudflare-workers.png alt="Cloudflare Workers dan Blog Jekyll Serverless"></a><div class=card-body><ul class="card-meta list-inline mb-2"><li class="list-inline-item mb-2"></li><li class="list-inline-item mb-2"><span>18 Nov, 2020</span></li><li class="list-inline-item mb-2"><ul class="card-meta-tag list-inline"><li class=list-inline-item><a href=https://kutubuku.surge.sh/tags/cloudflare>cloudflare</a></li><li class=list-inline-item><a href=https://kutubuku.surge.sh/tags/serverless>serverless</a></li><li class=list-inline-item><a href=https://kutubuku.surge.sh/tags/workers>workers</a></li></ul></li></ul><h3 class=mb-3><a class=post-title href=https://kutubuku.surge.sh/cloudflare-workers-dan-blog-jekyll-serverless/>Cloudflare Workers dan Blog Jekyll Serverless</a></h3><p>Apa itu “Cloudflare Worker” adalah JavaScript yang Anda tulis yang berjalan di edge Cloudflare. “Cloudflare Service Worker” secara khusus adalah …</p></div></article></div></div></div></div></div></div></section><footer class=section-sm><div class=container><div class="row justify-content-center align-items-center"><div class=col-lg-5><div class="newsletter-block font-primary"><h3 class="h4 mb-4 font-weight-700 text-center">Subscribe for our monthly newsletter.</h3><form class="px-0 px-sm-3 px-md-5" action="https://gmail.us4.list-manage.com/subscribe/post?u=463ee871f45d2d93748e77cad&amp;amp;id=a0a2c6d074" method=post name=mailchimp_form_name target=_blank><div class=input-group><input form=subscription type=text class=form-control placeholder="Enter your email" aria-label=Subscription required autocomplete=new-email><div class=input-group-append><button type=submit name=subscription class=input-group-text aria-label="Subscription Button"><i class="icon las la-paper-plane"></i></button></div></div><div style=position:absolute;left:-5000px aria-hidden=true><input type=text name=b_463ee871f45d2d93748e77cad_a0a2c6d074 tabindex=-1></div></form></div></div><div class="col-lg-12 text-center mt-5"><ul class="list-inline footer-menu mb-4"><li class="list-inline-item mx-3"><a href=https://kutubuku.surge.sh/about/>About</a></li><li class="list-inline-item mx-3"><a href=https://kutubuku.surge.sh/author/>Authors</a></li><li class="list-inline-item mx-3"><a href=https://kutubuku.surge.sh/privacy/>Privacy</a></li><li class="list-inline-item mx-3"><a href=https://kutubuku.surge.sh/terms-conditions/>Terms & Conditions</a></li></ul><ul class="social-links icon-box list-unstyled list-inline font-weight-500 mb-3"><li class="list-inline-item text-center"><a href=https://www.facebook.com/wilfauzy aria-label=social-icon><i class="lab lab la-facebook-f"></i></a></li><li class="list-inline-item text-center"><a href=https://www.twitter.com/wilfauzy aria-label=social-icon><i class="lab lab la-twitter"></i></a></li><li class="list-inline-item text-center"><a href=https://www.instagram.com/wilfauzy aria-label=social-icon><i class="lab lab la-instagram"></i></a></li></ul><p class="mb-0 font-weight-500 copyright-text content">Designed & Developed By <a href=https://gethugothemes.com/>Gethugothemes</a></p></div></div></div></footer><script data-turbolinks-suppress-warning src=/js/vendor.min.145a21dc1d3b6180ba4053b597f77d01206a5207dbc280de83d4151958109b94fad45e42ce423c4c4cf0cef270a67279b4db5d19f05e3eee33b3838de0028318.js integrity="sha512-FFoh3B07YYC6QFO1l/d9ASBqUgfbwoDeg9QVGVgQm5T61F5CzkI8TEzwzvJwpnJ5tNtdGfBePu4zs4ON4AKDGA=="></script></body></html>